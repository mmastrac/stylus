#!/usr/bin/env clitest --v0

using tempdir;

$ stylus init new-project
! Initializing directory: "new-project"...
! Done!
! 
! Run `stylus run "new-project"` to start the server

$ stylus run new-project --dry-run
! Stylus %{DATA} is listening on 0.0.0.0:8000!
! Dry run complete. Exiting.

$ stylus test new-project/config.yaml --monitor my-monitor
! [%{DATA} WARN  stylus::config] Passed configuration location "new-project/config.yaml" was a file -- inferring directory from parent
! Monitor Log
! -----------
! 
! %{DATA} [exec  ] Starting
! %{DATA} [stdout] Write your test script here
! %{DATA} [exec  ] Termination: 0
! 
! State
! -----
! 
! {
!   "id": "my-monitor",
!   "config": {
!     "interval": "30s",
!     "timeout": "10s",
!     "command": "%{PATH}"
!   },
!   "status": {
!     "status": "green",
!     "code": 0,
!     "description": "Success",
!     "css": {
!       "metadata": {}
!     },
!     "metadata": {}
!   },
!   "children": {}
! }
! 
! CSS
! ---
! 
! /* my-monitor */
! 
! /* Default rules */
! [data-monitor-id="my-monitor"] {
!   --monitor-id: "my-monitor";
!   --monitor-status: green;
!   --monitor-code: 0;
!   --monitor-description: "Success";
! }
!

$ rm -rf new-project

$ stylus init new-project/config.yaml
! [%{DATA} WARN  stylus::config] Passed configuration location "new-project/config.yaml" has a yaml file extension -- inferring directory as parent
! Initializing directory: "new-project"...
! Done!
! 
! Run `stylus run "new-project"` to start the server

# etc
$ find new-project
! new-project
*
! new-project/monitor.d
*
